  - name: Use Node.js
    uses: actions/setup-node@v4
    with:
      node-version: 18
      cache: 'npm'

  - name: Install dependencies
    run: npm ci

  - name: Build
    run: npm run build --if-present

  - name: Run tests
    if: always()
    run: npm test --if-present

  - name: Upload build artifact
    if: success() && always() # keep safe
    uses: actions/upload-artifact@v4
    with:
      name: dist
      path: dist